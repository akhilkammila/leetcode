#include <string>
#include <vector>
#include <iostream>
#include <math.h>
using namespace std;

/*
Takeaways:
consider doing dp the other way around to make looping easier
be very mindful of integer overflow
(checking if < another number after doing a calculation does not work, have to check before calculation)
*/

#ifdef LOCAL
#define DEBUG(...) debug(#__VA_ARGS__, __VA_ARGS__)
#include </Users/akhilkammila/Competitive Programming/debug.h>
#else
#define DEBUG(...) 47;
#endif

class Solution {
public:
    const int mod = 1e9+7;

    int numberOfArrays(string s, int k) {
        vector<int> dp(s.size()+1);
        dp[0] = 1; // base case: no characters

        // dp recurrence
        for(int n = 1; n < s.size()+1; n++) {
            // look at previous states for transition
            long long addingNumber = 0;
            long long base = 1;

            for(int t = n-1; t>=0; t--) {
                if (t != n-1) base *= 10;
                if (base > k) break;
                if (s[t] == '0') continue; // prevent numbers starting with 0
                
                addingNumber += (s[t] - '0') * base;
                if (addingNumber > k) break; // eliminates unnecessary transitions
                dp[n] = (dp[n] + dp[t]) % mod;
            }
        }
        return dp[s.size()];
    }
};

int main() {
    Solution s = Solution();
    string inputS = "8757636299206439661818769467805268880345701514572885569761281875368607187852296858464407481247622675047832337213851356537310849183290445280003691626061251674930688645188606846796214463944649238221121193472727599217480132896480077684960519568848112133766763061077466328396639134260315846625204322086610295240526785670193486519185710847644131351518042828184846214825966300275339538134233892498056816627973679531863150722375663222433037714629071623319125942500770763868950471360092073353454975215971750494497315520031385362804538341293780862927291658806971307971592094364619041032120418742346266080913060446701932877393067012303311471918328334734538416815387814545779140766163756319385336522929267172982955323205357639643975416839340986631918274505737695049017662936855448428285593232215549842845562561686617104697394393391628948985524157334786552276766283281006451368337952709473157057122082338686680638014849806044134354889322132296652505343746735569920224104454544646481747560959326722519581197470633124934509344181844346528512783093276524070182262667177888219140658440619622613141888200991884496450439360189202087160999364942540614691677519659030992614512978763816905795875507382497588231180202651754495242479446029140152900234056354249118126785445473209556678244322627144268618910314394760966980197134676793731783199641107909518704739673735320637559766461790956154859239871092887721195630724533695278270112335619694183632781485770491460338739365213568335865774476640422674031885643078324221052498285970261841379675057965277396150412682662681554188419905399520145236662142296659953589781602469609312800815739949447088926059597341162001505225381463650414531246953308279952414999276899281020386803073771957827788556734315956595930269182781982846992983761269728186094327597380976129284735623516511108632187760898177538923991639680092764209183932563468511394273787772477641539414462346738503549254297103597274031423607478238020463643115142311962103679889395059436366931184462314581941982617155868889112882107223261843716250537142950814758422317494923635489238631573584543825365158668370068434108667113283575291316515564541394201277845571295434196104348682201948038930283372198032323759560542906847551453423457906173831377984668680084635030612918473824559370570547461452251761406511434635388671625453479175878614889304821242559047778539493589077407169345868650749163560349323701946165239320256842029855127120273298290794386461017169579181480237497618972754244046073293321253595621345543978300090426269657139681888847916374269446634322564652294186628277874602272466326813073608948943103937354707715665279710128645852283144653056027822538470556250968582329423283726653502496463796564105105261236714302298663375326819362447507208484412946135413805891074987377020820095538120662970307318459154341504690026839700262682849095871977899793176919991867513459185344444917828287703437317643547583306296772001968203463067580083716914067402186105111436141613547645914981252710838467828204983829669086730502627494860180547923203481281836327922664082643313455591647526647340846792004991229736188349707332744931308488031207132039456977153636950480298531779416247678759916552465488786783642633020156723292420303818713385475679811145945952271766371861688114243880048116401087431552985179190687798505742354498588918577083991185063241490633663397112249075836939491765718013112634834946821332518070083669047640043880737373464152942659628177558449467040320277851957327610980882568266450096648128915230482406261970195315549099311402291912617210520599308221356517813566459861346773363815886214273834705716451010783321550301266659435482152791612947466630415363949810659517678934896914866272981756086176686200407079555977374522425791981443169748986025590673139719993845436715946994255812104386823442614975471321254622068469620568500109419566066831358934636555684365717593576932372735659273847843288698525810426777126324679488559076922585848439632591271768172975834351272866408777125963428291397241687116415727965613232402274226887118895336378019132495743020692807206555536537713007629172786045674456963827028533344832849136964274551410937683078079498000658043886450446145461496207727637486289460578806046467769067951814815019382533572967640591302689247931682498369557523758760460364021022388193112526757857181549409131185818271034525514445207736797564511686885132475885894821316563693380653516654873158256423859155505136036151660903569367194553303579560186730850779116908908859990032558648941641460365732961899786214504322028339329250518616591358960246143879062889135796526860254945386281178551415244504786242396286653639217832795333911665232135869550405683437854362756888012648267466703777811139312398466628540594249070029013057120892970990601608857454371277763258818347434979045601784715200790099133810447629759805745411036867426346942911252654772181541138277087586686874102457811713298982519913083078388790234312700148535190177526065046486528543697024725180599882310100145676957431195089976209432494315331498826835200435713372229670012568682111881483633118825618319265801559960567815390691444763317032946801163468015420862152965755892047339674986878803434341638481005587751487245826597075440192194333205196390526168353706575907846533397883710966967240383274332090819170355617516843782965686401293338103720214041503956666474342057832317785037097085482907703327118218423537246212509965507659995160603110482538128718272725582403598930932776046186571122024884983515726352758508229350939935683063485887436832433012847003116568358004568903555951615324537110793980839205355738324880501215895379896037273286612058961228457326057452731881668678750930183981585536232463973757443386191032732295802564010156659284590131624567795301706546588895703072638608103044278691010335146582789859419188896141075785515480359225438396678165303725743050764146741089170210037305018091998787137254826785115613126829250471956856549815665662199001550775646929152385064388066928375317943309187521977109662376058473928552331791256227091773166047119852438499442793946552316001230318548078873375711819461115722882711718171582334497030736122476092042616272210980885356541320815114233654997740353626755809300124749447454344475606713470475697310185841826916273971447152161340581751907905881613463236364855106179703980688186136912297467701507674090912505587431453413426498749834579815034886744332074786286802317211679549715927147728091611213108979505082120696408176017436506554751846931667356954824523453429290897203641766501513780029832010505544787215472455186572311829768560782154295829487212249357222757431594596523966675408683408345569392951984698062775186787519850564971710474661065564316637803460323172666926725481189216353522272777050587012949664995654016881058774007482185610314883923828655052035402121788724871433611301678482874971330225360610839925768954380148084850946258542748553142095981174312490566567877673827696386508851394082371868222826501484262749890381585930751201368143323992155532232354244663637829719358345009593492327395065652258343844045471736938323866455244068967272205344847277425623506233567756886760903817232657746332845885747362529024061182211111293719622765583253236657263131630054584556456254554759851379845355191584048004414569172935830553294545124594028045194890157445859306427109402341390238561543504776211060665134638311114770616735553988607085355668216621165937846831362146039952639005587104179146142552744315788011642574969845771232025520047873187063433602352482998152924929673179110630680228378701213683263418870524678844159307835432640524925709450332441675243747931810530524831380038577979176671581413379150137632174022830121322123223588751110981693826158572011991707474202337227384489690944958160229291927078887167375529408526313714563661728487962758723487356785764201480243537640084105384834297293526768460646343278163352862574614114736234986414127651617488047504721256032546134550076305486343849702115881461061776030571980040010462250343219663268027154623722667459515473640331167031005782573176321576192617652077228241740402984787812340191640587656934831418553912116437444293086175512923422733039796730347592856197291038876765123283562332188634018835375360356929227963119036613493813534297555925561332916988578593282429800593471908846908371884978645975779606597269455389045258186075626769122422464134577933952316991062420417388424030331206144363164914604749141606341658059180885656838187671706844753522651023071745341296198588230711070846347789954857588049745467971315391248230773015739325049085124653965668311038120271421239300454873830321789394867194355337311821267990020931223200679185099429695148363444736401152674129729503003496958327848136296352977522950393020856196381659652791512051132729627820202811121483868254302383972941751905984127155013977813650817725272693172977899583978273212300732014538413570476901059899176592247684860751109586042333168241093856483946833411967633324459985581020591048214017443170888";
    int k = 1000000000;
    cout << s.numberOfArrays(inputS, k);
}